// prisma/schema.prisma (CÓDIGO COMPLETO)

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model PLAYER {
  player_id         Int        @id @default(autoincrement())
  player_name       String
  email             String     @unique
  password          String
  current_garden_id Int? 
  
  current_garden GARDENS? @relation(fields: [current_garden_id], references: [garden_id])
  INVENTORYs     INVENTORY[]
  TASKs          TASKS[]
  GardenProgress GardenProgress[] // ✅ Relación a la nueva tabla
}

model GARDENS {
  garden_id   Int     @id @default(autoincrement())
  garden_name String  @unique
  level_1_img String?
  level_2_img String?
  level_3_img String?
  level_4_img String?
  level_5_img String?

  PLAYERs        PLAYER[]
  GardenProgress GardenProgress[] // ✅ Relación a la nueva tabla
}

// ✅ TABLA COMPLETAMENTE NUEVA
model GardenProgress {
  player_id Int
  garden_id Int
  level     Int @default(1)

  PLAYER  PLAYER  @relation(fields: [player_id], references: [player_id])
  GARDENS GARDENS @relation(fields: [garden_id], references: [garden_id])

  @@id([player_id, garden_id])
}


model CONSUMABLES {
  consumable_id   Int       @id @default(autoincrement())
  consumable_name String    @unique
  consumable_img  String?
  INVENTORYs      INVENTORY[]
}

model INVENTORY {
  player_id     Int
  consumable_id Int
  quantity      Int @default(0)

  PLAYER      PLAYER      @relation(fields: [player_id], references: [player_id])
  CONSUMABLES CONSUMABLES @relation(fields: [consumable_id], references: [consumable_id])

  @@id([player_id, consumable_id])
}

model TASKS {
  task_id         Int     @id @default(autoincrement())
  player_id       Int
  titulo          String  @default("")
  tipo            String  @default("Productividad")
  completed_flag  Boolean @default(false)
  eliminated_flag Boolean @default(false)
  PLAYER          PLAYER  @relation(fields: [player_id], references: [player_id])
}